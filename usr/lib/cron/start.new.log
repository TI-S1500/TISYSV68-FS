#-----------------------------------------------------------------------------
# COPYRIGHT (c)  1986  TEXAS INSTRUMENTS INCORPORATED   ALL RIGHTS RESERVED
#-----------------------------------------------------------------------------
#
#		@(#)new.log	1.4 (TI) 92/09/24
#
# This script is to ripple the old SYS.ERR.LOGs down 1 spot in the sequence,
# and start a new log for the new day.
#
# This script is run each midnight by cron so that the SYS.ERR.LOG won't grow
# without bounds.
#
#
#
#

mv  /usr/adm/SYS.ERR.LOG3  /usr/adm/SYS.ERR.LOG4 > /dev/null 2>&1
mv  /usr/adm/SYS.ERR.LOG2  /usr/adm/SYS.ERR.LOG3 > /dev/null 2>&1
mv  /usr/adm/SYS.ERR.LOG1  /usr/adm/SYS.ERR.LOG2 > /dev/null 2>&1
cp  /etc/SYS.ERR.LOG   /usr/adm/SYS.ERR.LOG1 > /dev/null 2>&1
cp  /dev/null          /etc/SYS.ERR.LOG > /dev/null 2>&1

#     ############################################################
#	Copyright (c) 1984 AT&T
#	  All Rights Reserved

#	THIS IS UNPUBLISHED PROPRIETARY SOURCE CODE OF AT&T
#	The copyright notice above does not evidence any
#	actual or intended publication of such source code.

#	Copyright (c) 1984 AT&T
#	  All Rights Reserved

#	THIS IS UNPUBLISHED PROPRIETARY SOURCE CODE OF AT&T
#	The copyright notice above does not evidence any
#	actual or intended publication of such source code.

#ident	"@(#)cron:logchecker.sh	1.4"

# this command is used to determine if the cron log file is approaching the
# maximum size.  This number has been arbitrarily set at 250K (500 blocks). 
# If it is, then the log file will be moved to olog.
# This command is executed by the crontab entry 'adm'

#set umask
umask 022

# log files
LOG=/usr/lib/cron/log
OLOG=/usr/lib/cron/olog

# set the high-water mark of the file
LIMIT=500

# find the size of the log file (in blocks)
if [ -f $LOG ]
then
	FILESIZE=`du -a $LOG | cut -f1`
else
	exit
fi

# move log file to olog file if the file is too big
if [ $FILESIZE -ge $LIMIT ]
then
	cp $LOG $OLOG
	rm $LOG
	touch $LOG
	chgrp bin $OLOG
fi

